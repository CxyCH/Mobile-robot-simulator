<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T7U3">obscost</span>, <span class="var type1" id="S3T7U4">goaldist</span>] = get_pathcosts(<span class="var type1" id="S4T1U7">xpaths</span>, <span class="var type1" id="S5T1U8">ypaths</span>, <span class="var type1" id="S6T1U9">xmesh</span>, <span class="var type1" id="S7T1U10">ymesh</span>, <span class="var type1" id="S8T1U11">grid4obscost</span>, <span class="var type1" id="S9T28U12">robot_pos</span>, <span class="var type1" id="S10T11U13">goal</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="mxinfo " id="T2:U10"><span class="var type1" id="S11T2U16">npath</span>          = <span class="mxinfo " id="T2:U12">size(<span class="var type1" id="S4T1U19">xpaths</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo " id="T7:U14"><span class="var type1" id="S2T7U23">obscost</span>        = <span class="mxinfo " id="T7:U16">zeros(<span class="var type1" id="S11T2U26">npath</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo " id="T7:U18"><span class="var type1" id="S3T7U30">goaldist</span>       = <span class="mxinfo " id="T7:U20">zeros(<span class="var type1" id="S11T2U33">npath</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S14T2U37">path_idx</span> = <span class="mxinfo " id="T2:U23">1</span>:<span class="var type1" id="S11T2U40">npath</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line">    <span class="mxinfo " id="T3:U25"><span class="var type1" id="S15T3U43">curr_path</span> = <span class="mxinfo " id="T3:U27">[<span class="mxinfo " id="T7:U28"><span class="mxinfo " id="T25:U29"><span class="var type1" id="S4T1U48">xpaths</span>(<span class="var type1" id="S14T2U49">path_idx</span>, <span class="mxinfo " id="T32:U32">:</span>)</span>'</span> <span class="mxinfo " id="T7:U33"><span class="mxinfo " id="T25:U34"><span class="var type1" id="S5T1U53">ypaths</span>(<span class="var type1" id="S14T2U54">path_idx</span>, <span class="mxinfo " id="T32:U37">:</span>)</span>'</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line">    <span class="mxinfo " id="T7:U38"><span class="var type1" id="S16T7U58">predvals</span>  = <span class="mxinfo " id="T7:U40">interp2(<span class="var type1" id="S6T1U61">xmesh</span>, <span class="var type1" id="S7T1U62">ymesh</span>, <span class="var type1" id="S8T1U63">grid4obscost</span>, <span class="mxinfo " id="T7:U44"><span class="var type1" id="S15T3U65">curr_path</span>(<span class="mxinfo " id="T32:U46">:</span>, <span class="mxinfo " id="T9:U47">1</span>)</span>, <span class="mxinfo " id="T7:U48"><span class="var type1" id="S15T3U69">curr_path</span>(<span class="mxinfo " id="T32:U50">:</span>, <span class="mxinfo " id="T9:U51">2</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line">    <span class="mxinfo " id="T2:U52"><span class="var type1" id="S18T2U74">maxval</span>    = <span class="mxinfo " id="T2:U54">max(<span class="var type1" id="S16T7U77">predvals</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line">    <span class="mxinfo " id="T11:U56"><span class="var type1" id="S20T11U80">end_pos</span>   = <span class="mxinfo " id="T11:U58"><span class="var type1" id="S15T3U82">curr_path</span>(<span class="mxinfo " id="T2:U60">end</span>, <span class="mxinfo " id="T33:U61">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line">    <span class="mxinfo " id="T2:U62"><span class="mxinfo " id="T2:U63"><span class="var type1" id="S2T7U89">obscost</span>(<span class="var type1" id="S14T2U90">path_idx</span>)</span>  = <span class="var type1" id="S18T2U91">maxval</span></span>;  <span class="comment">% lower the better</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line">    <span class="mxinfo " id="T2:U67"><span class="mxinfo " id="T2:U68"><span class="var type1" id="S3T7U95">goaldist</span>(<span class="var type1" id="S14T2U96">path_idx</span>)</span> = <span class="mxinfo " id="T2:U71">norm(<span class="mxinfo " id="T11:U72"><span class="var type1" id="S10T11U100">goal</span> - <span class="mxinfo " id="T11:U74"><span class="fcn" id="F152N4:B102">get_ref_cart_pos</span>(<span class="var type1" id="S9T28U103">robot_pos</span>, <span class="var type1" id="S20T11U104">end_pos</span>)</span></span>)</span></span>; <span class="comment">% lower the better</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo " id="T7:U77"><span class="var type1" id="S2T7U107">obscost</span>     = <span class="mxinfo " id="T7:U79"><span class="var type1" id="S2T7U109">obscost</span> / (<span class="mxinfo " id="T2:U81"><span class="mxinfo " id="T2:U82">max(<span class="var type1" id="S2T7U114">obscost</span>)</span> + <span class="mxinfo " id="T2:U84">1E-6</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo " id="T7:U85"><span class="var type1" id="S3T7U118">goaldist</span>    = <span class="mxinfo " id="T7:U87"><span class="var type1" id="S3T7U120">goaldist</span> / <span class="mxinfo " id="T2:U89">max(<span class="var type1" id="S3T7U123">goaldist</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line"></span></span>
</pre>
